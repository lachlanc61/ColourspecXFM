SIFDIR=$SIFDIR
IMAGENAME='xfmreadout_latest'
APPDIR="$(dirname "$(dirname "$(readlink -f "${BASH_SOURCE}")")")"
DATADIR="$APPDIR/data"

binds="/tmp,$DATADIR:/data,$APPDIR:/repo"

if [ "$#" -lt 1 ]; then
    echo "WARNING: No arguments given, will use example datafile to demonstrate functionality"
    args="-f /data/example_datafile.GeoPIXE -m"
else
    args="$@"
fi

#apptainer run --containall --bind $binds  $SIFDIR/$IMAGENAME.sif -f /data/example_datafile.GeoPIXE -m

apptainer exec --containall --bind $binds  $SIFDIR/$IMAGENAME.sif python /repo/xfmreadout/entry_raw.py $args